---
import { throwError } from "@package/common";
import { getDB } from "@package/database";
import type { AssetId } from "@package/database/types/public/Asset";
import Navbar from "@sections/navbar/Navbar.astro";
import Avatars from "./index.astro";

const db = await getDB();
const assetId = Astro.params.avatarId ?? throwError("No asset id found");
const account = Astro.locals.account ?? throwError("No account found");
await db
	.updateTable("public.account")
	.where("id", "=", account.id)
	.set({
		avatarAssetId: assetId as AssetId,
	})
	.executeTakeFirstOrThrow();
---

<Avatars />

<Navbar id="navbar" hx-swap-oob="true" />